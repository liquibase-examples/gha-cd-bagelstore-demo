{
  "permissions": {
    "allow": [
      "Read(//Users/recampbell/workspace/liquibase-patterns/docs/**)",
      "Read(//Users/recampbell/workspace/liquibase-patterns/repos/postgres-flow-policy-demo/**)",
      "Read(//Users/recampbell/workspace/liquibase-patterns/repos/Liquibase-workshop-repo/**)",
      "Read(//Users/recampbell/workspace/liquibase-patterns/repos/**)",
      "Bash(if [ -f \"README.md\" ])",
      "Bash(then cat README.md)",
      "Bash(else echo \"No README.md found\")",
      "Bash(fi)",
      "Bash(git init:*)",
      "Bash(git branch:*)",
      "Bash(git add:*)",
      "Bash(git commit -m \"$(cat <<''EOF''\nPhase 1: Infrastructure Setup - Complete Terraform and Liquibase Flows\n\nComplete implementation of Phase 1 from requirements-design-plan.md.\n\nTerraform Infrastructure:\n- Multi-instance support via demo_id variable\n- RDS PostgreSQL with 4 databases (dev, test, staging, prod)\n- AWS Secrets Manager for credentials\n- S3 buckets for flow files (public) and reports (private)\n- App Runner services for all 4 environments\n- Route53 DNS records\n- Comprehensive outputs and documentation\n\nLiquibase Flows:\n- pr-validation-flow.yaml - PR validation with policy checks\n- main-deployment-flow.yaml - Main branch deployment with artifact creation\n- 12 policy checks configured at BLOCKER severity\n- Pattern based on postgres-flow-policy-demo\n\nKey Features:\n- All resources tagged with demo_id for multi-instance support\n- AWS Secrets Manager native integration\n- Operation reports uploaded to S3\n- Fixed instance count on App Runner (cost control)\n- Public RDS access (demo only)\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(aws sts get-caller-identity:*)",
      "Bash(aws configure:*)",
      "Read(//Users/recampbell/.aws/**)",
      "Bash(aws:*)",
      "Bash(git commit -m \"$(cat <<''EOF''\nMake Route53 DNS optional and improve Terraform usability\n\nEnhanced Terraform configuration to support deployments without Route53:\n- Made Route53 DNS optional via enable_route53 variable (defaults to false)\n- App Runner services always get default URLs, Route53 adds custom domains\n- Added terraform.tfvars.example template with comprehensive documentation\n- Improved tag consistency (Requestor instead of deployed_by)\n- Updated README with clearer prerequisites and AWS SSO guidance\n\nChanges:\n- variables.tf: Added enable_route53 flag, made domain_name/route53_zone_id optional\n- route53.tf: Conditionally create DNS records only if enable_route53 = true\n- outputs.tf: Show App Runner URLs when Route53 disabled\n- main.tf: Standardized tag names (Requestor, Account)\n- README.md: Document optional Route53, terraform.tfvars.example workflow\n- terraform.tfvars.example: Complete template with all variables documented\n\nThis enables quick demos without Route53 setup while preserving custom DNS capability.\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(terraform:*)",
      "Bash(export AWS_PROFILE=liquibase-csteam-operator)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator terraform apply)",
      "Bash(gh repo view:*)",
      "Bash(git log:*)",
      "Bash(cat:*)",
      "Bash(gh api:*)",
      "Bash(uv init:*)",
      "Bash(uv add:*)",
      "Bash(gh issue view:*)",
      "Bash(docker compose:*)",
      "Bash(lsof:*)",
      "Bash(xargs kill:*)",
      "Bash(if [ -f ~/.config/claude-code/settings.json ])",
      "Bash(then)",
      "Bash(elif [ -f ~/Library/Application Support/claude-code/settings.json ])",
      "Bash(else)",
      "Read(//Users/recampbell/Library/**)",
      "mcp__playwright__browser_navigate:*",
      "mcp__playwright__browser_snapshot:*",
      "mcp__playwright__browser_take_screenshot:*",
      "mcp__playwright__browser_click:*",
      "mcp__playwright__browser_type:*",
      "mcp__playwright__browser_fill_form:*",
      "mcp__playwright__browser_press_key:*",
      "mcp__playwright__browser_wait_for:*",
      "mcp__playwright__browser_evaluate:*",
      "mcp__playwright__browser_console_messages:*",
      "mcp__playwright__browser_network_requests:*",
      "mcp__playwright__browser_close:*",
      "mcp__playwright__browser_resize:*",
      "mcp__playwright__browser_select_option:*",
      "mcp__playwright__browser_hover:*",
      "mcp__playwright__browser_drag:*",
      "mcp__playwright__browser_handle_dialog:*",
      "mcp__playwright__browser_file_upload:*",
      "mcp__playwright__browser_tabs:*",
      "mcp__playwright__browser_navigate_back:*",
      "Bash(git push:*)",
      "Bash(uv run:*)",
      "Bash(curl:*)",
      "mcp__context7__resolve-library-id",
      "WebSearch",
      "WebFetch(domain:registry.terraform.io)",
      "WebFetch(domain:developer.harness.io)",
      "WebFetch(domain:revealjs.com)",
      "Bash(find:*)",
      "mcp__atlassian__search",
      "mcp__atlassian__getAccessibleAtlassianResources",
      "mcp__atlassian__atlassianUserInfo",
      "Bash(echo $AWS_PROFILE)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws s3 ls)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws dynamodb list-tables --region us-east-1)",
      "Bash(gh issue list:*)",
      "Bash(export AWS_PROFILE=liquibase-sandbox-admin)",
      "mcp__context7__get-library-docs",
      "Bash(git check-ignore:*)",
      "Bash(gh run list:*)",
      "Bash(gh run view:*)",
      "Bash(docker inspect:*)",
      "Bash(mkdir:*)",
      "Bash(git commit:*)",
      "Bash(git show:*)",
      "mcp__atlassian__getJiraIssue",
      "mcp__playwright__browser_navigate",
      "Bash(awk '{print $NF}')",
      "Bash(tree .harness/)",
      "Bash(git -C /Users/recampbell/workspace/harness-gha-bagelstore log --oneline --all -20)",
      "Bash(source harness/.env)",
      "Bash(git -C /Users/recampbell/workspace/harness-gha-bagelstore log --oneline --all -10 -- '.harness/*infra*')",
      "Bash(git -C /Users/recampbell/workspace/harness-gha-bagelstore show 5da20c1 --stat)",
      "Bash(git -C /Users/recampbell/workspace/harness-gha-bagelstore show f18fc60:'.harness/orgs/default/projects/bagel_store_demo/infrastructure_definitions/psr_dev_infra.yaml')",
      "Bash(git -C /Users/recampbell/workspace/harness-gha-bagelstore show f18fc60 --name-status)",
      "Bash(git -C /Users/recampbell/workspace/harness-gha-bagelstore show f18fc60:.harness/orgs/default/projects/bagel_store_demo/envs/PreProduction/psr_dev/infras/psr_dev_infra.yaml)",
      "Bash(git -C /Users/recampbell/workspace/harness-gha-bagelstore show f18fc60:.harness/orgs/default/projects/bagel_store_demo/envs/PreProduction/psr_test/infras/psr_test_infra.yaml)",
      "Bash(git -C /Users/recampbell/workspace/harness-gha-bagelstore show f18fc60:.harness/orgs/default/projects/bagel_store_demo/envs/PreProduction/psr_staging/infras/psr_staging_infra.yaml)",
      "Bash(git -C /Users/recampbell/workspace/harness-gha-bagelstore show f18fc60:.harness/orgs/default/projects/bagel_store_demo/envs/Production/psr_prod/infras/psr_prod_infra.yaml)",
      "Bash(xargs -I {} basename {})",
      "Bash(./scripts/get-pipeline-executions.sh 3)",
      "Bash(docker logs harness-delegate-psr --tail 50)",
      "Bash(docker exec harness-delegate-psr ls -la /opt/harness-delegate/scripts/)",
      "Bash(./scripts/get-execution-details.sh qjcP9H0BTK--QYLQE-VAfA)",
      "Bash(./scripts/get-pipeline-executions.sh 1)",
      "Bash(./scripts/get-stage-logs.sh qjcP9H0BTK--QYLQE-VAfA \"Deploy to Dev\")",
      "Bash(./scripts/get-pipeline-executions.sh 10)",
      "Bash(docker ps --filter \"name=harness-delegate\" --format \"table {{.Names}}\\t{{.Status}}\\t{{.Image}}\")",
      "Bash(gh secret list)",
      "Bash(gh variable list)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws secretsmanager list-secrets --region us-east-1 --query 'SecretList[?contains(Name, `psr`) || contains(Name, `rds`)].Name' --output table)",
      "Bash(HARNESS_API_KEY=\"pat._dYBmxlLQu61cFhvdkV4Jw.68ebbc30d74c165ac805138c.K2CrfyFXoGibfpKqAWWi\")",
      "WebFetch(domain:docs.liquibase.com)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws secretsmanager get-secret-value --secret-id psr/rds/username --region us-east-1)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws secretsmanager get-secret-value --secret-id psr/rds/username --region us-east-1 --query SecretString --output text)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws secretsmanager describe-secret --secret-id psr/rds/username --region us-east-1)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws secretsmanager get-random-password --password-length 20 --exclude-punctuation)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws secretsmanager get-secret-value --secret-id psr/rds/credentials --region us-east-1 --query SecretString --output text)",
      "Bash(env)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws sts get-caller-identity)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws iam get-user --user-name harness-bagel-store-deployer)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws iam list-attached-user-policies --user-name harness-bagel-store-deployer)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws iam get-policy --policy-arn \"arn:aws:iam::907240911534:policy/HarnessBagelStoreDeploymentPolicy\" --query 'Policy.DefaultVersionId' --output text)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws iam get-policy-version --policy-arn \"arn:aws:iam::907240911534:policy/HarnessBagelStoreDeploymentPolicy\" --version-id v1 --query 'PolicyVersion.Document')",
      "Read(//private/tmp/**)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws apprunner describe-service --service-arn \"arn:aws:apprunner:us-east-1:907240911534:service/bagel-store-psr-dev/c2190e5aab3f40f1a0e22560b9af3633\" --query 'Service.ServiceUrl' --output text)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws logs describe-log-groups --log-group-name-prefix \"/aws/apprunner/bagel-store-psr-dev\" --query 'logGroups[*].logGroupName' --output table)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws logs tail \"/aws/apprunner/bagel-store-psr-dev/c2190e5aab3f40f1a0e22560b9af3633/application\" --since 30m --format short)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws logs tail \"/aws/apprunner/bagel-store-psr-dev/c2190e5aab3f40f1a0e22560b9af3633/service\" --since 30m --format short)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws logs tail \"/aws/apprunner/bagel-store-psr-dev/c2190e5aab3f40f1a0e22560b9af3633/service\" --since 2h --format short)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws iam get-role-policy --role-name bagel-store-psr-apprunner-instance-role --policy-name apprunner-secrets-policy)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws iam list-attached-role-policies --role-name bagel-store-psr-apprunner-instance-role)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws iam list-role-policies --role-name bagel-store-psr-apprunner-instance-role)",
      "Bash(AWS_PROFILE=liquibase-csteam-operator aws iam get-role-policy --role-name bagel-store-psr-apprunner-instance-role --policy-name bagel-store-psr-apprunner-secrets-policy)",
      "Bash(docker --version)",
      "Bash(./scripts/harness-api.sh POST \"https://app.harness.io/gateway/pipeline/api/pipeline/execute/Deploy_Bagel_Store?accountIdentifier=_dYBmxlLQu61cFhvdkV4Jw&orgIdentifier=default&projectIdentifier=bagel_store_demo\" '{\n  \"\"inputSetReferences\"\": [\"\"webhook_default\"\"],\n  \"\"runtimeInputYaml\"\": \"\"pipeline:\\n  identifier: Deploy_Bagel_Store\\n  variables:\\n    - name: VERSION\\n      type: String\\n      value: dev-ab91d58\\n    - name: GITHUB_ORG\\n      type: String\\n      value: liquibase-examples\\n    - name: DEPLOYMENT_TARGET\\n      type: String\\n      value: aws\\n\"\"\n}')",
      "Bash(./scripts/get-template.sh Coordinated_DB_App_Deployment)",
      "WebFetch(domain:apidocs.harness.io)",
      "Bash(xargs -n1 basename)"
    ],
    "deny": [],
    "ask": []
  }
}
